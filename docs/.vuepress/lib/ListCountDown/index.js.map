{"version":3,"file":"index.js","sources":["../../../src/lib/ListCountDown/index.js"],"sourcesContent":["/*\r\n * @Description:长列表倒计时\r\n * @Author: shufei\r\n * @Date: 2020-11-16 12:43:12\r\n * @LastEditTime: 2020-11-23 14:34:11\r\n * @LastEditors: shufei\r\n */\r\nconst padStart = (string, length, pad) => {\r\n    const s = String(string)\r\n    if (!s || s.length >= length) return String(string)\r\n    return `${Array(length + 1 - s.length).join(pad)}${string}`\r\n}\r\n\r\nfunction ListCountDown(opt) {\r\n    this.timer = null //定时器\r\n    this.format = opt.format || 'dd天hh时mm分ss秒' //内容格式\r\n    this.list = opt.list || [] // 长列表\r\n    this.key = opt.timeKey // 别名结束时间key\r\n    this.content = opt.previewKey // 回显内容key\r\n    this.type = opt.type || 1 //长列表显示类型\r\n    this.update()\r\n}\r\n/**\r\n * @description: 更新\r\n * @param :\r\n * @return {*}\r\n */\r\nListCountDown.prototype.update = function () {\r\n    this.operation(1)\r\n}\r\n/**\r\n * @description: 取消\r\n * @param :\r\n * @return {*}\r\n */\r\nListCountDown.prototype.cancel = function () {\r\n    this.operation(0)\r\n}\r\n/**\r\n * @description: 计算倒计时的 d 天 h 时 m 分 s 秒\r\n * @param :\r\n * @return {*}\r\n */\r\nListCountDown.prototype.calc = function (item) {\r\n    let time = item[this.key]\r\n    let e = (new Date((time.trim().includes(' ') ? time.trim() : time.trim() + ' 00:00:00').replace(/-/g, '/')) - new Date()) / 1000\r\n    e <= 0 && (item.isExpred = true)\r\n    let date = {\r\n        d: e <= 0 ? '00' : Math.floor(e / 86400),\r\n        h: e <= 0 ? '00' : padStart(parseInt(Math.floor((e % 86400) / 3600)), 2, 0),\r\n        m: e <= 0 ? '00' : padStart(parseInt(Math.floor((e % 86400) % 3600) / 60), 2, 0),\r\n        s: e <= 0 ? '00' : padStart(parseInt(e % 60), 2, 0)\r\n    }\r\n    if (this.type == 1) {\r\n        return this.format.replace(/d{1,2}|h{1,2}|m{1,2}|s{1,2}|S/g, a => (a.charAt(0) === 'd' || a.length === 2 ? date[a.charAt(0)] : Number(date[a.charAt(0)])))\r\n    } else {\r\n        ;(item.d = date.d), (item.h = date.h), (item.m = date.m), (item.s = date.s)\r\n    }\r\n}\r\n/**\r\n * @description: 长列表定时器操作\r\n * @param : {Number} type 操作类型 1 更新 0 取消\r\n * @return {*} viod\r\n */\r\nListCountDown.prototype.operation = function (type) {\r\n    if (!this.list.length) return\r\n    clearInterval(this.timer)\r\n    this.timer = null\r\n    if (type == 1) {\r\n        this.timer = setInterval(() => {\r\n            for (let i = 0, len = this.list.length; i < len; i++) {\r\n                if (this.type == 1) {\r\n                    this.list[i][this.content] = this.calc(this.list[i])\r\n                } else {\r\n                    this.calc(this.list[i])\r\n                }\r\n            }\r\n        }, 1000)\r\n    }\r\n}\r\n\r\nexport default ListCountDown\r\n"],"names":["padStart","string","length","pad","s","String","Array","join","ListCountDown","opt","timer","format","list","key","timeKey","content","previewKey","type","update","prototype","operation","cancel","calc","item","time","this","e","Date","trim","includes","replace","isExpred","date","d","Math","floor","h","parseInt","m","a","charAt","Number","clearInterval","setInterval","i","len","_this"],"mappings":"6OAOiB,SAAXA,EAAYC,EAAQC,EAAQC,OACxBC,EAAIC,OAAOJ,UACZG,GAAKA,EAAEF,QAAUA,EAAeG,OAAOJ,aAClCK,MAAMJ,EAAS,EAAIE,EAAEF,QAAQK,KAAKJ,WAAOF,GAGvD,SAASO,EAAcC,QACdC,MAAQ,UACRC,OAASF,EAAIE,QAAU,oBACvBC,KAAOH,EAAIG,MAAQ,QACnBC,IAAMJ,EAAIK,aACVC,QAAUN,EAAIO,gBACdC,KAAOR,EAAIQ,MAAQ,OACnBC,gBAOTV,EAAcW,UAAUD,OAAS,gBACxBE,UAAU,IAOnBZ,EAAcW,UAAUE,OAAS,gBACxBD,UAAU,IAOnBZ,EAAcW,UAAUG,KAAO,SAAUC,OACjCC,EAAOD,EAAKE,KAAKZ,KACjBa,GAAK,IAAIC,MAAMH,EAAKI,OAAOC,SAAS,KAAOL,EAAKI,OAASJ,EAAKI,OAAS,aAAaE,QAAQ,KAAM,MAAQ,IAAIH,MAAU,IAC5HD,GAAK,IAAMH,EAAKQ,UAAW,OACvBC,EAAO,CACPC,EAAGP,GAAK,EAAI,KAAOQ,KAAKC,MAAMT,EAAI,OAClCU,EAAGV,GAAK,EAAI,KAAO1B,EAASqC,SAASH,KAAKC,MAAOT,EAAI,MAAS,OAAQ,EAAG,GACzEY,EAAGZ,GAAK,EAAI,KAAO1B,EAASqC,SAASH,KAAKC,MAAOT,EAAI,MAAS,MAAQ,IAAK,EAAG,GAC9EtB,EAAGsB,GAAK,EAAI,KAAO1B,EAASqC,SAASX,EAAI,IAAK,EAAG,OAEpC,GAAbD,KAAKR,YACEQ,KAAKd,OAAOmB,QAAQ,iCAAkC,SAAAS,SAAsB,MAAhBA,EAAEC,OAAO,IAA2B,IAAbD,EAAErC,OAAe8B,EAAKO,EAAEC,OAAO,IAAMC,OAAOT,EAAKO,EAAEC,OAAO,OAElJjB,EAAKU,EAAID,EAAKC,EAAKV,EAAKa,EAAIJ,EAAKI,EAAKb,EAAKe,EAAIN,EAAKM,EAAKf,EAAKnB,EAAI4B,EAAK5B,GAQjFI,EAAcW,UAAUC,UAAY,SAAUH,cACrCQ,KAAKb,KAAKV,SACfwC,cAAcjB,KAAKf,YACdA,MAAQ,KACD,GAARO,SACKP,MAAQiC,YAAY,eAChB,IAAIC,EAAI,EAAGC,EAAMC,EAAKlC,KAAKV,OAAQ0C,EAAIC,EAAKD,IAC5B,GAAbE,EAAK7B,KACL6B,EAAKlC,KAAKgC,GAAGE,EAAK/B,SAAW+B,EAAKxB,KAAKwB,EAAKlC,KAAKgC,IAEjDE,EAAKxB,KAAKwB,EAAKlC,KAAKgC,KAG7B"}