{"version":3,"file":"index.js","sources":["../../../src/lib/store/src/local.js","../../../src/lib/store/src/session.js","../../../src/lib/store/index.js"],"sourcesContent":["const local = localStorage\nconst _set = local.setItem.bind(local)\nconst _get = local.getItem.bind(local)\nconst _remove = local.removeItem.bind(local)\nconst _parse = v => JSON.parse(_get(v))\nconst _stringify = JSON.stringify\nconst isString = v => typeof v === 'string'\nconst isObject = v => Object.prototype.toString.call(v) === '[object Object]'\nconst isNum = n => (typeof n == 'symbol' ? false : !isNaN(parseFloat(n)) && isFinite(n))\n\nconst set = function (a, b) {\n    if (isString(a)) {\n        _set(a, isString(b) ? b : _stringify(b))\n    } else if (isObject(a)) {\n        for (let k in a) {\n            _set(k, isString(a[k]) ? a[k] : _stringify(a[k]))\n        }\n    }\n}\n\nconst setExpired = function (...arg) {\n    let [a, b, c] = arg\n    let d = +new Date()\n    let fn = function (k, v, t) {\n        _set(\n            k,\n            _stringify({\n                startTime: d, //创建并存入时间戳\n                expiredTime: t, //过期时间\n                value: v\n            })\n        )\n    }\n    if (arg.length == 1) {\n        //设置多个值\n        if (isObject(a)) {\n            for (let k in a) {\n                fn(k, a[k], 0)\n            }\n        }\n    } else if (arg.length == 2) {\n        if (isString(a)) {\n            fn(a, 0, b)\n        } else if (isObject(a) && isNum(b)) {\n            for (let k in a) {\n                fn(k, a[k], Number(b))\n            }\n        }\n    } else if (arg.length == 3) {\n        if (isString(a) && isNum(c)) {\n            fn(a, b, Number(c))\n        }\n    }\n}\n\nconst get = function (k) {\n    if (isString(k)) {\n        return _parse(k)\n    } else if (Array.isArray(k)) {\n        return k.reduce((p, c) => {\n            if (isString(c) && c in local) {\n                p[c] = _parse(c)\n            }\n            return p\n        }, {})\n    }\n}\n\nconst getExpired = function (k) {\n    let v = _parse(k)\n    if (v && 'startTime' in v) {\n        // 如果大于就是过期了，如果小于或等于就还没过期\n        if (new Date() - v.startTime > v.expiredTime) {\n            _remove(k)\n            return false\n        } else {\n            return v.value\n        }\n    } else {\n        return v\n    }\n}\n\nconst del = function (k) {\n    if (isString(k)) {\n        _remove(k)\n    } else if (Array.isArray(k)) {\n        for (let i = 0, len = k.length; i < len; i++) {\n            let j = k[i]\n            if (isString(j)) {\n                _remove(j)\n            }\n        }\n    }\n}\n\nconst clearAll = function () {\n    local.clear()\n}\n\nconst clearAllExpired = function () {\n    let keys = Object.keys(local)\n    let len = keys.length\n    for (let i = 0; i < len; i++) {\n        let o = _parse(k)\n        if (o && 'expiredTime' in o) _remove(k)\n    }\n}\n\nconst each = function (cb) {\n    let a = Object.keys(localStorage)\n    for (let i = 0, len = a.length; i < len; i++) {\n        let k = a[i]\n        let v = _parse(k)\n        cb(k, v)\n    }\n}\n\nexport default {\n    set,\n    get,\n    del,\n    each,\n    setExpired,\n    getExpired,\n    clearAll,\n    clearAllExpired\n}\n","const session = sessionStorage\nconst _get = session.getItem.bind(session)\nconst _set = session.setItem.bind(session)\nconst _remove = session.removeItem.bind(session)\nconst _clear = session.clear.bind(session)\nconst _stringify = JSON.stringify\nconst _parse = v => JSON.parse(_get(v))\nconst isString = v => typeof v === 'string'\nconst isObject = v => Object.prototype.toString.call(v) === '[object Object]'\nconst isArray = Array.isArray\n\nconst get = function (k) {\n    if (isString(k)) {\n        try {\n            return _parse(k)\n        } catch (e) {\n            return _get(k)\n        }\n    } else if (isArray(k)) {\n        return k.reduce((p, c) => {\n            let i = _parse(c)\n            i && (p[c] = i)\n            return p\n        }, {})\n    }\n}\n\nconst set = function (k, v) {\n    if (isString(k)) {\n        _set(k, v) //set(key,val)\n    } else if (isArray(k)) {\n        //set([{key1:val1},{key2:val2}]) or set([{key1:val1,k11:val22},{key2:val2}])\n        for (let i = 0; i < k.length; i++) {\n            let j = k[i]\n            if (isObject(j)) {\n                for (let k in j) {\n                    _set(k, isString(j[k]) ? j[k] : _stringify(j[k]))\n                }\n            }\n        }\n    }\n}\n\nconst del = function (k) {\n    if (isString(k)) {\n        _remove(k)\n    } else if (Array.isArray(k)) {\n        for (let i = 0, len = k.length; i < len; i++) {\n            let j = k[i]\n            isString(j) && _remove(j)\n        }\n    }\n}\n\nconst clearAll = function () {\n    session.clear()\n}\n\nconst each = function (cb) {\n    let arr = Object.keys(sessionStorage)\n    for (let i = 0; i < arr.length; i++) {\n        cb(arr[i], get(arr[i]))\n    }\n}\n\nexport default {\n    get,\n    set,\n    del,\n    clearAll,\n    each\n}\n","/*\n * @Author: your name\n * @Date: 2021-06-06 15:55:08\n * @LastEditTime: 2021-06-08 22:09:20\n * @LastEditors: Please set LastEditors\n * @Description: In User Settings Edit\n * @FilePath: \\rutils\\src\\lib\\store\\index.js\n */\n\nimport local from './src/local'\nimport session from './src/session'\n\nexport default {\n    local,\n    session\n}\n"],"names":["_parse","v","JSON","parse","_get","isString","isObject","Object","prototype","toString","call","isNum","n","_typeof","isNaN","parseFloat","isFinite","local","localStorage","_set","setItem","bind","getItem","_remove","removeItem","_stringify","stringify","set","a","b","k","get","Array","isArray","reduce","p","c","del","i","len","length","j","each","cb","keys","setExpired","arg","fn","t","startTime","d","expiredTime","value","Date","Number","getExpired","clearAll","clear","clearAllExpired","o","session","sessionStorage","e","arr"],"mappings":"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"}