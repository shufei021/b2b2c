{"version":3,"file":"index.js","sources":["../../../src/lib/file/base64ToBlob.js","../../../src/lib/file/fileToBase64.js","../../../src/lib/file/index.js","../../../src/lib/file/bytesFormat.js","../../../src/lib/file/base64ToFile.js","../../../src/lib/file/blobToBase64.js","../../../src/lib/file/blobToFile.js","../../../src/lib/file/fileToBlob.js","../../../src/lib/file/downloadByBase64.js","../../../src/lib/file/downloadByImgLink.js","../../../src/lib/file/downloadByImgSelector.js"],"sourcesContent":["/**\n * @description: Base64 to Blob\n * @param { dataURL } base64 : file base64\n * @return { Blob }\n */\nconst base64ToBlob = function (base64) {\n    let mime = base64.split(',')[0].split(':')[1].split(';')[0] //mime type\n    let byte = window.atob(base64.split(',')[1]) //base64 decode\n    let arrayBuffer = new ArrayBuffer(byte.length) // create buffer array\n    let intArray = new Uint8Array(arrayBuffer) // create view\n    for (let i = 0, len = byte.length; i < len; i++) {\n        intArray[i] = byte.charCodeAt(i)\n    }\n    return new Blob([intArray], { type: mime })\n}\nexport default base64ToBlob\n","/**\n * @description: File to Base64\n * @param { File } file :  File\n * @return { Promise }\n */\nconst fileToBase64 = function (file) {\n    return new Promise(resole => {\n        let reader = new FileReader()\n        reader.readAsDataURL(file)\n        reader.onload = function () {\n            resole(this.result)\n        }\n    })\n}\nexport default fileToBase64\n","import bytesFormat from './bytesFormat'\nimport base64ToBlob from './base64ToBlob'\nimport base64ToFile from './base64ToFile'\nimport blobToBase64 from './blobToBase64'\nimport blobToFile from './blobToFile'\nimport fileToBase64 from './fileToBase64'\nimport fileToBlob from './fileToBlob'\nimport downloadByBase64 from './downloadByBase64'\nimport downloadByImgLink from './downloadByImgLink'\nimport downloadByImgSelector from './downloadByImgSelector'\n\nexport default {\n    bytesFormat,\n    base64ToBlob,\n    base64ToFile,\n    blobToBase64,\n    blobToFile,\n    fileToBase64,\n    fileToBlob,\n    downloadByBase64,\n    downloadByImgLink,\n    downloadByImgSelector\n}\n","/**\n * @description: (bytes)字节数自动转换\n * @param {Number} bytes: 字节数\n */\nconst bytesFormat = function (bytes) {\n    if (bytes === 0) return '0 B'\n    if (!bytes) return ''\n    let k = 1024\n    let sizes = ['B', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB']\n    let i = Math.floor(Math.log(bytes) / Math.log(k))\n    let num = bytes / Math.pow(k, i)\n    return num.toFixed(2) + ' ' + sizes[i]\n}\nexport default bytesFormat\n","/**\n * @description: Base64 to File\n * @param dataURL   {String}  base64\n * @param fileName   {String}  file name\n * @returns {File}\n */\nconst base64ToFile = function (base64, fileName) {\n    let arr = base64.split(','),\n        mimeType = arr[0].match(/:(.*?);/)[1], //base64文件类型\n        bStr = atob(arr[1]),\n        n = bStr.length,\n        u8arr = new Uint8Array(n)\n    while (n--) {\n        u8arr[n] = bStr.charCodeAt(n)\n    }\n    return new File([u8arr], fileName, { type: mimeType })\n}\nexport default base64ToFile\n","/**\n * @description: Blob to Base64\n * @param  {Blob} blob\n * @return {Promise<dataURL>} Base64\n */\nconst blobToBase64 = function (blob) {\n    return new Promise(resolve => {\n        let reader = new FileReader()\n        reader.onload = function (e) {\n            resolve(e.target.result)\n        }\n        reader.readAsDataURL(blob)\n    })\n}\nexport default blobToBase64\n","/**\n * @description: Blob  to  File\n * @param  { Blob } blob\n * @param { String } filename : file name\n * @return { File } File\n */\nconst blobToFile = function (blob, filename) {\n    return new File([blob], filename, { type: blob.type, lastModified: Date.now() })\n}\nexport default blobToFile\n","import fileToBase64 from './fileToBase64'\nimport base64ToBlob from './base64ToBlob'\n/**\n * @description: File to Blob\n * @param  { File } file: File object\n * @return { Promise }\n */\nconst fileToBlob = function (file) {\n    return fileToBase64(file).then(r => base64ToBlob(r))\n}\nexport default fileToBlob\n","/**\n * @description: base64数据导出文件下载\n * @param {string} filename - 下载时的文件名\n * @param {dataURL} base64 - base64字符串\n */\nconst downloadByBase64 = function (base64, filename = 'default') {\n    let a = document.createElement('a')\n    a.style = 'display: none'\n    document.body.appendChild(a)\n    a.download = filename\n    a.href = base64\n    if (document.createEvent) {\n        let downloadEvt = document.createEvent('MouseEvents')\n        downloadEvt.initEvent('click', true, false)\n        a.dispatchEvent(downloadEvt)\n    } else if (document.createEventObject) {\n        a.fireEvent('onclick')\n    } else if (typeof a.onclick == 'function') {\n        a.onclick()\n    }\n    document.body.removeChild(a)\n}\nexport default downloadByBase64\n","/**\n * 根据 url下载图片\n * @param {string} url - 图片url地址\n * @return {Promise<dataURL>} :Base64\n */\nconst downloadByImgLink = function (url, w, h) {\n    return new Promise(resolve => {\n        let img = new Image()\n        img.src = url\n        img.crossOrigin = 'anonymous'\n        // img.setAttribute('crossOrigin', 'anonymous')\n        img.onload = function () {\n            //默认按比例压缩\n            ;(w = w || this.width), (h = h || this.height)\n            let quality = 0.95 // 默认图片质量为0.95\n            //生成canvas\n            let canvas = document.createElement('canvas')\n            let ctx = canvas.getContext('2d')\n            // 创建属性节点\n            canvas.setAttribute('width', w)\n            canvas.setAttribute('height', h)\n            ctx.drawImage(this, 0, 0, w, h)\n            // quality值越小，所绘制出的图像越模糊\n            let base64 = canvas.toDataURL('image/png', quality)\n            // 回调函数返回base64的值\n            resolve(base64)\n        }\n    })\n}\nexport default downloadByImgLink\n","/**\n * Download Image to local:\n * the main principle is to use the download attribute of a tag and todataurl () of canvas\n * @param { String | Element } selector: Selector of img tag or img element\n * @param { String } name：Download Image Name\n */\nconst downloadByImgSelector = function (selector, name) {\n    let image = new Image()\n    // Solving cross domain canvas pollution problem\n    image.setAttribute('crossOrigin', 'anonymous')\n\n    image.onload = function () {\n        // 创建一个canvas标签\n        let canvas = document.createElement('canvas')\n        // 设置canvas的宽高\n        canvas.width = image.width\n        canvas.height = image.height\n        // 获取canvas的2d界面\n        let context = canvas.getContext('2d')\n        // 把图片画在canvas上\n        context.drawImage(image, 0, 0, canvas.width, canvas.height)\n        // 把canvas的内容转化为base64格式\n        let url = canvas.toDataURL('image/png')\n        // 生成一个a元素\n        let a = document.createElement('a')\n        // 创建一个单击事件\n        let event = new MouseEvent('click')\n        // 将a的download属性设置为我们想要下载的图片名称，若name不存在则使用‘下载图片名称’作为默认名称\n        a.download = name || 'defaultName'\n        // 将生成的URL设置为a.href属性\n        a.href = url\n        // 触发a的单击事件\n        a.dispatchEvent(event)\n    }\n    // 获取img上的src值，赋值之后，完成之后会调用onload事件\n    image.src = typeof selector === 'string' ? document.querySelector(selector).src : selector.src\n}\nexport default downloadByImgSelector\n"],"names":["base64ToBlob","base64","mime","split","byte","window","atob","arrayBuffer","ArrayBuffer","length","intArray","Uint8Array","i","len","charCodeAt","Blob","type","fileToBase64","file","Promise","resole","reader","FileReader","readAsDataURL","onload","this","result","bytesFormat","bytes","Math","floor","log","pow","toFixed","base64ToFile","fileName","arr","mimeType","match","bStr","n","u8arr","File","blobToBase64","blob","resolve","e","target","blobToFile","filename","lastModified","Date","now","fileToBlob","then","downloadByBase64","a","document","createElement","style","body","appendChild","download","href","createEvent","downloadEvt","initEvent","dispatchEvent","createEventObject","fireEvent","onclick","removeChild","downloadByImgLink","url","w","h","img","Image","src","crossOrigin","width","height","canvas","ctx","getContext","setAttribute","drawImage","toDataURL","downloadByImgSelector","selector","name","image","event","MouseEvent","querySelector"],"mappings":"oOAKqB,SAAfA,EAAyBC,WACvBC,EAAOD,EAAOE,MAAM,KAAK,GAAGA,MAAM,KAAK,GAAGA,MAAM,KAAK,GACrDC,EAAOC,OAAOC,KAAKL,EAAOE,MAAM,KAAK,IACrCI,EAAc,IAAIC,YAAYJ,EAAKK,QACnCC,EAAW,IAAIC,WAAWJ,GACrBK,EAAI,EAAGC,EAAMT,EAAKK,OAAQG,EAAIC,EAAKD,IACxCF,EAASE,GAAKR,EAAKU,WAAWF,UAE3B,IAAIG,KAAK,CAACL,GAAW,CAAEM,KAAMd,ICRnB,SAAfe,EAAyBC,UACpB,IAAIC,QAAQ,SAAAC,OACXC,EAAS,IAAIC,WACjBD,EAAOE,cAAcL,GACrBG,EAAOG,OAAS,WACZJ,EAAOK,KAAKC,iBCCT,CACXC,YCRgB,SAAUC,MACZ,IAAVA,EAAa,MAAO,UACnBA,EAAO,MAAO,OAGfhB,EAAIiB,KAAKC,MAAMD,KAAKE,IAAIH,GAASC,KAAKE,IAFlC,cAGEH,EAAQC,KAAKG,IAHf,KAGsBpB,IACnBqB,QAAQ,GAAK,IAHZ,CAAC,IAAK,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MAGxBrB,IDEpCZ,aAAAA,EACAkC,aERiB,SAAUjC,EAAQkC,WAC/BC,EAAMnC,EAAOE,MAAM,KACnBkC,EAAWD,EAAI,GAAGE,MAAM,WAAW,GACnCC,EAAOjC,KAAK8B,EAAI,IAChBI,EAAID,EAAK9B,OACTgC,EAAQ,IAAI9B,WAAW6B,GACpBA,KACHC,EAAMD,GAAKD,EAAKzB,WAAW0B,UAExB,IAAIE,KAAK,CAACD,GAAQN,EAAU,CAAEnB,KAAMqB,KFA3CM,aGViB,SAAUC,UACpB,IAAIzB,QAAQ,SAAA0B,OACXxB,EAAS,IAAIC,WACjBD,EAAOG,OAAS,SAAUsB,GACtBD,EAAQC,EAAEC,OAAOrB,SAErBL,EAAOE,cAAcqB,MHKzBI,WIVe,SAAUJ,EAAMK,UACxB,IAAIP,KAAK,CAACE,GAAOK,EAAU,CAAEjC,KAAM4B,EAAK5B,KAAMkC,aAAcC,KAAKC,SJUxEnC,aAAAA,EACAoC,WKXe,SAAUnC,UAClBD,EAAaC,GAAMoC,KAAUtD,ILWpCuD,iBMdqB,SAAUtD,EAAV,OAAkBgD,+BAAlB,EAAA,EAA6B,UAC9CO,EAAIC,SAASC,cAAc,KAC/BF,EAAEG,MAAQ,gBACVF,SAASG,KAAKC,YAAYL,GAC1BA,EAAEM,SAAWb,EACbO,EAAEO,KAAO9D,EACLwD,SAASO,cACLC,EAAcR,SAASO,YAAY,gBAC3BE,UAAU,SAAS,GAAM,GACrCV,EAAEW,cAAcF,IACTR,SAASW,kBAChBZ,EAAEa,UAAU,WACe,mBAAbb,EAAEc,SAChBd,EAAEc,UAENb,SAASG,KAAKW,YAAYf,INA1BgB,kBOfsB,SAAUC,EAAKC,EAAGC,UACjC,IAAIxD,QAAQ,SAAA0B,OACX+B,EAAM,IAAIC,MACdD,EAAIE,IAAML,EACVG,EAAIG,YAAc,YAElBH,EAAIpD,OAAS,WAEPkD,EAAIA,GAAKjD,KAAKuD,MAASL,EAAIA,GAAKlD,KAAKwD,WAGnCC,EAASzB,SAASC,cAAc,UAChCyB,EAAMD,EAAOE,WAAW,MAE5BF,EAAOG,aAAa,QAASX,GAC7BQ,EAAOG,aAAa,SAAUV,GAC9BQ,EAAIG,UAAU7D,KAAM,EAAG,EAAGiD,EAAGC,GAEzB1E,EAASiF,EAAOK,UAAU,YAThB,KAWd1C,EAAQ5C,OPJhBuF,sBQf0B,SAAUC,EAAUC,OAC1CC,EAAQ,IAAId,MAEhBc,EAAMN,aAAa,cAAe,aAElCM,EAAMnE,OAAS,eAEP0D,EAASzB,SAASC,cAAc,UAEpCwB,EAAOF,MAAQW,EAAMX,MACrBE,EAAOD,OAASU,EAAMV,OAERC,EAAOE,WAAW,MAExBE,UAAUK,EAAO,EAAG,EAAGT,EAAOF,MAAOE,EAAOD,YAEhDR,EAAMS,EAAOK,UAAU,aAEvB/B,EAAIC,SAASC,cAAc,KAE3BkC,EAAQ,IAAIC,WAAW,SAE3BrC,EAAEM,SAAW4B,GAAQ,cAErBlC,EAAEO,KAAOU,EAETjB,EAAEW,cAAcyB,IAGpBD,EAAMb,KAA0B,iBAAbW,EAAwBhC,SAASqC,cAAcL,GAAgBA,GAANX"}